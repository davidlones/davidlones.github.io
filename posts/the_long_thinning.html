<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>The Long Thinning [Reconstructed]</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
body { background:#020617; }
.custom-scrollbar::-webkit-scrollbar { width:4px; }
.custom-scrollbar::-webkit-scrollbar-thumb { background:#064e3b; }
</style>
</head>

<body class="bg-neutral-950 text-emerald-500 font-mono">
<div id="root"></div>

<script type="module">
import React, { useState, useMemo, useEffect } from "https://esm.sh/react";
import { createRoot } from "https://esm.sh/react-dom/client";
import {
  AreaChart, Area, Line, XAxis, YAxis,
  CartesianGrid, Tooltip,
  ResponsiveContainer, ReferenceLine
} from "https://esm.sh/recharts";
import {
  Database, Users, Activity,
  Zap, ChevronLeft, ChevronRight
} from "https://esm.sh/lucide-react";

const ARCHIVE_DATA = [
  { year:0, exited:3, buffer:3.2, jobs:62, active:397 },
  { year:1, exited:9, buffer:2.6, jobs:60.5, active:391 },
  { year:2, exited:22, buffer:2.1, jobs:59, active:378 },
  { year:3, exited:40, buffer:1.5, jobs:57, active:360 },
  { year:4, exited:60, buffer:0.9, jobs:55, active:340 },
  { year:5, exited:75, buffer:-0.2, jobs:53.5, active:325 },
  { year:6, exited:90, buffer:-0.4, jobs:52, active:310 },
  { year:7, exited:120, buffer:-0.5, jobs:51.5, active:280 },
  { year:8, exited:140, buffer:-0.6, jobs:51, active:260 },
  { year:9, exited:150, buffer:-0.7, jobs:50.5, active:250 },
  { year:10, exited:152, buffer:-0.8, jobs:50, active:248 }
];

function App() {
  const [year, setYear] = useState(0);
  const [playing, setPlaying] = useState(false);

  useEffect(()=>{
    if(!playing) return;
    const id = setInterval(()=>{
      setYear(y=> y<10? y+1 : 0);
    },2000);
    return ()=>clearInterval(id);
  },[playing]);

  const stats = ARCHIVE_DATA[year];

  const dots = useMemo(()=>{
    return Array.from({length:400}).map((_,i)=>{
      if(i < stats.exited) return "exited";
      if(i < stats.exited + (400 - stats.active)) return "shadow";
      return "active";
    });
  },[stats]);

  return React.createElement("div",
    {className:"min-h-screen p-6 flex flex-col gap-6"},

    React.createElement("header",
      {className:"flex justify-between border-b border-emerald-900 pb-4"},
      React.createElement("div", null,
        React.createElement("h1",
          {className:"text-xl font-bold flex gap-2 items-center"},
          React.createElement(Database,{size:18}),
          "THE LONG THINNING [RECONSTRUCTED]"
        ),
        React.createElement("div",{className:"text-xs text-emerald-700"},
          "Archival Simulation // CIV-ECON-Î”120"
        )
      ),
      React.createElement("div",{className:"text-right"},
        React.createElement("div",{className:"text-xs"},"YEAR #0# + ",year),
        React.createElement("div",
          {className:year>=5?"text-amber-500":"text-emerald-400"},
          year>=5?"OPTIMIZED_STABLE":"PARTICIPATORY"
        )
      )
    ),

    React.createElement("main",
      {className:"grid lg:grid-cols-12 gap-6 flex-grow"},

      React.createElement("section",
        {className:"lg:col-span-4 border border-emerald-900 p-4"},
        React.createElement("div",{className:"text-xs mb-2 flex gap-2"},
          React.createElement(Users,{size:14}),
          "Population Density"
        ),
        React.createElement("div",
          {className:"grid grid-cols-20 gap-1"},
          dots.map((d,i)=>
            React.createElement("div",{
              key:i,
              className:
                "aspect-square "+
                (d==="active"?"bg-emerald-500":
                 d==="shadow"?"bg-emerald-900":
                 "bg-neutral-800 opacity-20")
            })
          )
        )
      ),

      React.createElement("section",
        {className:"lg:col-span-8 border border-emerald-900 p-4"},
        React.createElement("div",{className:"text-xs mb-4 flex gap-2"},
          React.createElement(Activity,{size:14}),
          "System Metrics"
        ),
        React.createElement("div",{className:"h-64"},
          React.createElement(ResponsiveContainer,{width:"100%",height:"100%"},
            React.createElement(AreaChart,{data:ARCHIVE_DATA},
              React.createElement(CartesianGrid,{stroke:"#064e3b"}),
              React.createElement(XAxis,{dataKey:"year",stroke:"#065f46"}),
              React.createElement(YAxis,{stroke:"#065f46"}),
              React.createElement(ReferenceLine,{y:0,stroke:"#ef4444"}),
              React.createElement(Area,{dataKey:"buffer",stroke:"#10b981",fill:"#10b98144"}),
              React.createElement(Line,{dataKey:"jobs",stroke:"#34d399",dot:false}),
              React.createElement(ReferenceLine,{x:year,stroke:"#fbbf24"})
            )
          )
        )
      )
    ),

    React.createElement("footer",
      {className:"flex items-center gap-4 border border-emerald-900 p-3"},
      React.createElement("button",
        {onClick:()=>setPlaying(p=>!p),className:"border px-3 py-1"},
        playing?"PAUSE":React.createElement(Zap,{size:16})
      ),
      React.createElement("button",{onClick:()=>setYear(y=>Math.max(0,y-1))},
        React.createElement(ChevronLeft,{size:18})
      ),
      React.createElement("input",{
        type:"range",
        min:0,
        max:10,
        value:year,
        onChange:e=>setYear(+e.target.value),
        className:"flex-grow accent-emerald-500"
      }),
      React.createElement("button",{onClick:()=>setYear(y=>Math.min(10,y+1))},
        React.createElement(ChevronRight,{size:18})
      )
    )
  );
}

createRoot(document.getElementById("root")).render(
  React.createElement(App)
);
</script>

</body>
</html>
