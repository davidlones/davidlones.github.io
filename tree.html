<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>XP Desktop Tree</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Optional: smooth fonts -->
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        background: radial-gradient(circle at top, #1a2340 0%, #050713 60%, #000 100%);
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      }
      #root {
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    </style>
    <!-- React / ReactDOM / Babel from CDNs -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useRef, useEffect } = React;

      function ChristmasTreeCanvas({ width = 360, height = 480 }) {
        const canvasRef = useRef(null);

        useEffect(() => {
          const canvas = canvasRef.current;
          const ctx = canvas.getContext("2d");

          const dpr = window.devicePixelRatio || 1;
          canvas.width = width * dpr;
          canvas.height = height * dpr;
          canvas.style.width = width + "px";
          canvas.style.height = height + "px";
          ctx.scale(dpr, dpr);

          let animationFrameId;
          const lights = [];
          const snowflakes = [];
          const maxSnowflakes = 120;

          function createTreeLights() {
            lights.length = 0;
            const layers = 5;
            const baseWidth = width * 0.65;
            const topY = height * 0.18;
            const baseY = height * 0.7;
            const centerX = width / 2;

            for (let i = 0; i < layers; i++) {
              const t = i / (layers - 0.2);
              const y = topY + t * (baseY - topY);
              const w = baseWidth * (1 - t * 0.78);
              const count = 10 + i * 3;
              for (let j = 0; j < count; j++) {
                const ratio = j / (count - 1 || 1);
                const x = centerX - w / 2 + ratio * w;
                lights.push({
                  x: x + (Math.random() - 0.5) * 6,
                  y: y + (Math.random() - 0.5) * 6,
                  phase: Math.random() * Math.PI * 2,
                  hue: 20 + Math.random() * 300,
                });
              }
            }
          }

          function createSnowflakes() {
            snowflakes.length = 0;
            for (let i = 0; i < maxSnowflakes; i++) {
              snowflakes.push({
                x: Math.random() * width,
                y: Math.random() * height,
                r: 1 + Math.random() * 2.5,
                vy: 0.4 + Math.random() * 0.9,
                drift: (Math.random() - 0.5) * 0.35,
              });
            }
          }

          createTreeLights();
          createSnowflakes();

          function drawBackground() {
            const g = ctx.createLinearGradient(0, 0, 0, height);
            g.addColorStop(0, "#050716");
            g.addColorStop(0.5, "#050816");
            g.addColorStop(1, "#03040a");
            ctx.fillStyle = g;
            ctx.fillRect(0, 0, width, height);

            const radius = Math.max(width, height);
            const vg = ctx.createRadialGradient(
              width / 2,
              height * 0.15,
              radius * 0.15,
              width / 2,
              height / 2,
              radius * 0.9
            );
            vg.addColorStop(0, "rgba(80,100,200,0.1)");
            vg.addColorStop(1, "rgba(0,0,0,0.9)");
            ctx.fillStyle = vg;
            ctx.fillRect(0, 0, width, height);

            ctx.fillStyle = "rgba(255,255,255,0.65)";
            for (let i = 0; i < 40; i++) {
              const sx = Math.random() * width;
              const sy = Math.random() * height * 0.45;
              const sr = Math.random() * 0.8;
              ctx.beginPath();
              ctx.arc(sx, sy, sr, 0, Math.PI * 2);
              ctx.fill();
            }
          }

          function drawSnow() {
            ctx.save();
            ctx.globalAlpha = 0.85;
            ctx.fillStyle = "#ffffff";
            snowflakes.forEach((fl) => {
              ctx.beginPath();
              ctx.arc(fl.x, fl.y, fl.r, 0, Math.PI * 2);
              ctx.fill();
            });
            ctx.restore();
          }

          function updateSnow() {
            for (const fl of snowflakes) {
              fl.y += fl.vy;
              fl.x += fl.drift;

              if (fl.y > height + 5) {
                fl.y = -5;
                fl.x = Math.random() * width;
              }
              if (fl.x < -5) fl.x = width + 5;
              if (fl.x > width + 5) fl.x = -5;
            }
          }

          function drawTree() {
            const centerX = width / 2;
            const topY = height * 0.18;
            const baseY = height * 0.7;
            const baseWidth = width * 0.68;
            const layers = 5;

            const glow = ctx.createRadialGradient(
              centerX,
              baseY * 0.9,
              width * 0.1,
              centerX,
              baseY,
              width * 0.8
            );
            glow.addColorStop(0, "rgba(40,255,160,0.18)");
            glow.addColorStop(1, "rgba(0,0,0,0)");
            ctx.fillStyle = glow;
            ctx.fillRect(0, 0, width, height);

            for (let i = 0; i < layers; i++) {
              const t = i / (layers - 0.2);
              const y = topY + t * (baseY - topY);
              const w = baseWidth * (1 - t * 0.78);

              const grad = ctx.createLinearGradient(centerX, y - 40, centerX, y + 40);
              grad.addColorStop(0, "#1c824b");
              grad.addColorStop(0.5, "#0f5c33");
              grad.addColorStop(1, "#082d19");

              ctx.fillStyle = grad;
              ctx.beginPath();
              ctx.moveTo(centerX, y - 40);
              ctx.lineTo(centerX - w / 2, y + 50);
              ctx.lineTo(centerX + w / 2, y + 50);
              ctx.closePath();
              ctx.fill();

              ctx.strokeStyle = "rgba(190,255,220,0.12)";
              ctx.lineWidth = 1;
              ctx.stroke();
            }

            const trunkWidth = baseWidth * 0.16;
            const trunkHeight = height * 0.09;
            const trunkX = centerX - trunkWidth / 2;
            const trunkY = baseY + 40;
            const trunkGrad = ctx.createLinearGradient(
              trunkX,
              trunkY,
              trunkX + trunkWidth,
              trunkY + trunkHeight
            );
            trunkGrad.addColorStop(0, "#5a3a22");
            trunkGrad.addColorStop(1, "#2d1f14");

            ctx.fillStyle = trunkGrad;
            ctx.fillRect(trunkX, trunkY, trunkWidth, trunkHeight);

            ctx.fillStyle = "#f4f7ff";
            ctx.beginPath();
            ctx.moveTo(-10, height * 0.82);
            ctx.quadraticCurveTo(width * 0.3, height * 0.75, width * 0.55, height * 0.82);
            ctx.quadraticCurveTo(width * 0.8, height * 0.9, width + 10, height * 0.84);
            ctx.lineTo(width + 10, height + 10);
            ctx.lineTo(-10, height + 10);
            ctx.closePath();
            ctx.fill();
          }

          function drawStar(time) {
            const centerX = width / 2;
            const topY = height * 0.18;
            const baseRadius = 9;
            const pulse = 1 + Math.sin(time * 2) * 0.2;
            const r = baseRadius * pulse;

            ctx.save();
            ctx.translate(centerX, topY - 40);
            ctx.rotate(Math.sin(time * 0.6) * 0.05);

            const glowGrad = ctx.createRadialGradient(0, 0, 0, 0, 0, r * 3.2);
            glowGrad.addColorStop(0, "rgba(255,255,180,0.9)");
            glowGrad.addColorStop(0.4, "rgba(255,230,120,0.5)");
            glowGrad.addColorStop(1, "rgba(0,0,0,0)");
            ctx.fillStyle = glowGrad;
            ctx.beginPath();
            ctx.arc(0, 0, r * 3.2, 0, Math.PI * 2);
            ctx.fill();

            ctx.fillStyle = "#fff5b4";
            ctx.beginPath();
            const spikes = 5;
            const outerRadius = r;
            const innerRadius = r * 0.45;
            for (let i = 0; i < spikes * 2; i++) {
              const angle = (i * Math.PI) / spikes;
              const radius = i % 2 === 0 ? outerRadius : innerRadius;
              ctx.lineTo(Math.cos(angle) * radius, Math.sin(angle) * radius);
            }
            ctx.closePath();
            ctx.fill();

            ctx.restore();
          }

          function drawLights(time) {
            lights.forEach((l) => {
              const t = time * 3 + l.phase;
              const baseAlpha = 0.35 + 0.4 * (0.5 + 0.5 * Math.sin(t));
              const outerAlpha = baseAlpha * 0.7;

              const radius = 6.5;
              const grad = ctx.createRadialGradient(l.x, l.y, 0, l.x, l.y, radius);
              grad.addColorStop(0, `hsla(${l.hue}, 90%, 70%, ${outerAlpha})`);
              grad.addColorStop(1, "rgba(0,0,0,0)");
              ctx.fillStyle = grad;
              ctx.beginPath();
              ctx.arc(l.x, l.y, radius, 0, Math.PI * 2);
              ctx.fill();

              ctx.fillStyle = `hsla(${l.hue}, 100%, 75%, 0.95)`;
              ctx.beginPath();
              ctx.arc(l.x, l.y, 2.1, 0, Math.PI * 2);
              ctx.fill();
            });
          }

          function render(timestamp) {
            const time = timestamp / 1000;

            ctx.clearRect(0, 0, width, height);

            drawBackground();
            drawSnow();
            drawTree();
            drawLights(time);
            drawStar(time);

            updateSnow();
            animationFrameId = requestAnimationFrame(render);
          }

          animationFrameId = requestAnimationFrame(render);

          function handleResize() {
            const rect = canvas.getBoundingClientRect();
            const dprNew = window.devicePixelRatio || 1;
            canvas.width = rect.width * dprNew;
            canvas.height = rect.height * dprNew;
            ctx.setTransform(1, 0, 0, 1, 0, 0);
            ctx.scale(dprNew, dprNew);
            createTreeLights();
            createSnowflakes();
          }

          window.addEventListener("resize", handleResize);

          return () => {
            cancelAnimationFrame(animationFrameId);
            window.removeEventListener("resize", handleResize);
          };
        }, [width, height]);

        const wrapperStyle = {
          borderRadius: "12px",
          overflow: "hidden",
          border: "1px solid rgba(255,255,255,0.1)",
          backgroundColor: "black",
        };

        return (
          <div style={wrapperStyle}>
            <canvas ref={canvasRef} />
          </div>
        );
      }

      function App() {
        const appStyle = {
          margin: 0,
          padding: 0,
          width: "100vw",
          height: "100vh",
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          color: "#eee",
        };

        const cardStyle = {
          boxShadow: "0 24px 60px rgba(0,0,0,0.65)",
          borderRadius: "16px",
          padding: "16px 18px 12px",
          background:
            "linear-gradient(145deg, rgba(8,12,25,0.96), rgba(20,30,60,0.98))",
          border: "1px solid rgba(255,255,255,0.08)",
          backdropFilter: "blur(12px)",
        };

        const titleStyle = {
          fontSize: "14px",
          letterSpacing: "0.12em",
          textTransform: "uppercase",
          color: "#9fb3ff",
          marginBottom: "8px",
        };

        const subtitleStyle = {
          fontSize: "12px",
          color: "#b7c0e8",
          opacity: 0.8,
          marginBottom: "10px",
        };

        return (
          <div style={appStyle}>
            <div style={cardStyle}>
              <div style={titleStyle}>Desktop Tree</div>
              <div style={subtitleStyle}>XP spirit, 2025 renderer.</div>
              <ChristmasTreeCanvas width={360} height={480} />
            </div>
          </div>
        );
      }

      const rootEl = document.getElementById("root");
      const root = ReactDOM.createRoot(rootEl);
      root.render(<App />);
    </script>
  </body>
</html>